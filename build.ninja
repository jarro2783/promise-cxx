rule cxx
  command = g++-6.3.0 -o $out -c $in -std=c++17 -O0 -g -Wall $
    -fdiagnostics-color=always -fprofile-arcs -ftest-coverage

rule cxx_link
  command = g++-6.3.0 -o $out $in -pg -lgcov

build async.o: cxx async.cpp | promise.hpp async.h
build main.o: cxx main.cpp | promise.hpp async.h
build main: cxx_link main.o async.o
build test.o: cxx test.cpp | promise.hpp async.h
build test: cxx_link test.o async.o
